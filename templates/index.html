<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEC to Excel</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>SEC to Excel</h1>
            <p class="subtitle">Extract financial data from SEC filings into organized spreadsheets</p>
        </header>

        <!-- Step 1: Search -->
        <section id="step-search" class="step active">
            <div class="step-header">
                <span class="step-number">1</span>
                <h2>Search for a company</h2>
            </div>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Enter company name or ticker (e.g. AAPL, Microsoft)" autocomplete="off">
                <div id="search-results" class="dropdown hidden"></div>
            </div>
        </section>

        <!-- Step 2: Select filings -->
        <section id="step-filings" class="step hidden">
            <div class="step-header">
                <span class="step-number">2</span>
                <h2>Select filings</h2>
            </div>
            <div id="selected-company" class="selected-company"></div>
            <div class="filing-controls">
                <button id="btn-select-all-10k" class="btn-sm">All 10-Ks</button>
                <button id="btn-select-all-10q" class="btn-sm">All 10-Qs</button>
                <button id="btn-select-all-8k" class="btn-sm">All 8-Ks</button>
                <button id="btn-select-none" class="btn-sm btn-outline">Clear All</button>
            </div>
            <div id="filings-list" class="filings-list"></div>
            <div id="filings-loading" class="loading hidden">
                <div class="spinner"></div>
                <span>Loading filings from SEC EDGAR...</span>
            </div>
            <button id="btn-scan" class="btn-primary hidden" style="margin-top:16px">Scan Selected Filings</button>
            <div id="scan-loading" class="loading hidden">
                <div class="spinner"></div>
                <span id="scan-status">Downloading and scanning filings... This may take a minute.</span>
            </div>
            <div id="scan-error" class="error hidden"></div>
        </section>

        <!-- Step 3: Select tables -->
        <section id="step-tables" class="step hidden">
            <div class="step-header">
                <span class="step-number">3</span>
                <h2>Select additional tables</h2>
            </div>
            <p class="step-description">Core financials (Income Statement, Balance Sheet, Cash Flow) are always included. Select any additional tables you want in the Excel file:</p>
            <div class="filing-controls">
                <button id="btn-select-all-tables" class="btn-sm">Select All</button>
                <button id="btn-select-no-tables" class="btn-sm btn-outline">Clear All</button>
            </div>
            <div id="tables-list" class="filings-list"></div>
            <p id="tables-empty" class="hidden" style="color:#9ca3af;font-size:14px;margin-top:8px;">No additional tables found in the selected filings.</p>
        </section>

        <!-- Step 4: Generate -->
        <section id="step-generate" class="step hidden">
            <div class="step-header">
                <span class="step-number">4</span>
                <h2>Generate Excel</h2>
            </div>
            <p id="generate-summary"></p>
            <div class="output-toggle">
                <label class="radio-label">
                    <input type="radio" name="output-mode" value="multi" checked>
                    <span>Separate tabs</span>
                    <span class="radio-desc">Each table gets its own sheet</span>
                </label>
                <label class="radio-label">
                    <input type="radio" name="output-mode" value="single">
                    <span>Single sheet</span>
                    <span class="radio-desc">Everything on one sheet, stacked vertically</span>
                </label>
            </div>

            <!-- Company color theme -->
            <div class="color-theme-section">
                <h3>Excel Color Theme</h3>
                <p>Type a company name to use their brand colors in the Excel file, or pick custom colors below.</p>
                <div class="color-input-row">
                    <div class="color-input-group">
                        <label>Company</label>
                        <input type="text" id="color-company-input" placeholder="e.g. Apple, Nike, Walmart...">
                    </div>
                </div>
                <div class="color-match-result" id="color-match-result">
                    <div class="color-swatch" id="match-swatch-primary"></div>
                    <div class="color-swatch" id="match-swatch-accent"></div>
                    <span>Matched: <span class="match-label" id="match-label"></span></span>
                </div>
                <div class="custom-colors">
                    <div class="color-picker-group">
                        <label>Primary</label>
                        <input type="color" id="color-primary" value="#4472C4">
                    </div>
                    <div class="color-picker-group">
                        <label>Accent</label>
                        <input type="color" id="color-accent" value="#D9E1F2">
                    </div>
                </div>
            </div>

            <button id="btn-generate" class="btn-primary" style="margin-top:20px">Generate & Download Excel</button>
            <div id="generate-loading" class="loading hidden">
                <div class="spinner"></div>
                <span id="generate-status">Building Excel file...</span>
            </div>
            <div id="generate-error" class="error hidden"></div>
        </section>

        <!-- Reset -->
        <div id="reset-section" class="hidden">
            <button id="btn-reset" class="btn-outline">Start Over</button>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
